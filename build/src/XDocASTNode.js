"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _ = require("lodash");
/* Documentation */
/**
 * Removes undefined, null, and false properties from an object.
 *
 * # API
 *
 * ```
 * @param object
 * ```
 */
function sanitize(object) {
    // Object.keys(object).forEach((key) => (object[key] == null) && delete object[key]);
    return _.pickBy(object);
}
/**
 * Creates a Documentation node.
 *
 * # API
 *
 * ```
 * @param body: BodyNode - The body node. See. {@link XDocASTNode.ts::BodyNode}
 * @param text?: string - The string representation of the body node.
 * @return DocumentationNode - See {@link XDocASTNode.ts::DocumentationNode}.
 * ```
 */
function createDocumentationNode(body, text) {
    return { documentation: sanitize({ body, text }) };
}
exports.createDocumentationNode = createDocumentationNode;
/**
 * Creates a Body node.
 */
function createBodyNode(annotations, text) {
    return sanitize({ annotations, text });
}
exports.createBodyNode = createBodyNode;
/* Tag */
function createTagNode(name, identifier, type, expression, description, text) {
    return sanitize(Object.assign({}, name, identifier, { type }, expression, description, text));
}
exports.createTagNode = createTagNode;
function createTagNameNode(name, text) {
    return sanitize({ name, text });
}
exports.createTagNameNode = createTagNameNode;
function createTagIdentifierNode(identifier, property, text) {
    let node = {};
    if (identifier)
        Object.assign(node, { identifier, text });
    else if (property)
        Object.assign(node, { property, text });
    return sanitize(node);
}
exports.createTagIdentifierNode = createTagIdentifierNode;
function createOptionalTagIdentifierNode(identifier) {
    return identifier;
}
exports.createOptionalTagIdentifierNode = createOptionalTagIdentifierNode;
function createPropertyTagIdentifierNode(property, text) {
    return sanitize({ property, text });
}
exports.createPropertyTagIdentifierNode = createPropertyTagIdentifierNode;
function createIdentifierNode(text, optional = false, property) {
    if (!optional)
        optional = false;
    if (!property)
        property = [];
    return { identifier: sanitize({ optional, property, text }) };
}
exports.createIdentifierNode = createIdentifierNode;
function createOptionalIdentifierNode(optional = true, property, text) {
    return createIdentifierNode(text, optional, property);
}
exports.createOptionalIdentifierNode = createOptionalIdentifierNode;
/* Type */
/**
 *
 * Creates a Type node.
 *
 * # API
 *
 * ```
 * @export
 * @function createTypeNode
 * @param type: UnionTypeNode
 * | LambdaTypeNode
 * | TupleTypeNode
 * | PrimaryTypeNode
 * | ParenthesizedTypeNode
 * | UnaryTypeNode
 * | ObjectTypeNode
 * | ArrayTypeNode
 * | PropertyTypeNode
 * - The type of node to create.
 * @param optional = false
 * - Determines whether the type of node is optional.
 * ```
 */
function createTypeNode(type, optional = false, text) {
    return Object.assign({}, type, sanitize({ optional, text }));
}
exports.createTypeNode = createTypeNode;
/**
 * Creates an IntersectionType node.
 *
 * # API
 *
 * ```
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createIntersectTypeNode(left, right, text) {
    return { intersect: sanitize({ left, right, text }) };
}
exports.createIntersectTypeNode = createIntersectTypeNode;
/**
 * Creates an UnionType node.
 *
 * # API
 *
 * ```
 * @export
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createUnionTypeNode(left, right, text) {
    return { union: sanitize({ left, right, text }) };
}
exports.createUnionTypeNode = createUnionTypeNode;
/**
 * Creates a LambdaType node.
 *
 * # API
 *
 * ```
 * - The single parameter in a lambda type.
 * @param parameters: FormalParameterSequencce | undefined[] | null
 * - The sequence of parameters in a lambda type.
 * @param type: TypeNode
 * - The return type in a lambda type.
 * ```
 */
function createLambdaTypeNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return { lambda: sanitize({ parameters, type, text }) };
}
exports.createLambdaTypeNode = createLambdaTypeNode;
function createFormalParemeterSequenceNode(parameters, text) {
    return { parameters, text };
}
exports.createFormalParemeterSequenceNode = createFormalParemeterSequenceNode;
function createParameterNode(identifier, type, text) {
    return sanitize({ identifier, type, text });
}
exports.createParameterNode = createParameterNode;
function createTupleTypeNode(identifier, types, text) {
    return sanitize({ identifier, types, text });
}
exports.createTupleTypeNode = createTupleTypeNode;
function createPrimaryTypeNode(primary, text) {
    return sanitize({ primary, text });
}
exports.createPrimaryTypeNode = createPrimaryTypeNode;
function createKeywordNode(text) {
    return { keyword: { text } };
}
exports.createKeywordNode = createKeywordNode;
function createParenthesizedTypeNode(type, optional = false, text) {
    return { parenthesized: sanitize({ type, optional, text }) };
}
exports.createParenthesizedTypeNode = createParenthesizedTypeNode;
function createUnaryTypeNode(operator, right, text) {
    return { unary: sanitize({ operator, right, text }) };
}
exports.createUnaryTypeNode = createUnaryTypeNode;
function createObjectTypeNode(object, text) {
    if (!object)
        object = [];
    return sanitize({ object, text });
}
exports.createObjectTypeNode = createObjectTypeNode;
function createObjectPairTypeNode(key, value, text) {
    return sanitize({ key, value, text });
}
exports.createObjectPairTypeNode = createObjectPairTypeNode;
function createArrayTypeNode(type, types, text) {
    if (!types)
        types = [];
    return { array: sanitize({ type, types, text }) };
}
exports.createArrayTypeNode = createArrayTypeNode;
function createPropertyIdentifierNode(property, text) {
    return createIdentifierNode(text, false, property);
}
exports.createPropertyIdentifierNode = createPropertyIdentifierNode;
;
/* Expression */
function createExpressionNode(expression, text) {
    return sanitize({ expression, text });
}
exports.createExpressionNode = createExpressionNode;
function createUnaryExpressionNode(operator, right, text) {
    return { unary: sanitize({ operator, right, text }) };
}
exports.createUnaryExpressionNode = createUnaryExpressionNode;
function createBinaryExpressionNode(operator, left, right, text) {
    return { binary: sanitize({ left, right, operator, text }) };
}
exports.createBinaryExpressionNode = createBinaryExpressionNode;
function createArrayExpressionNode(array, text) {
    if (!array)
        array = [];
    return sanitize({ array, text });
}
exports.createArrayExpressionNode = createArrayExpressionNode;
function createObjectExpressionNode(object, text) {
    if (!object)
        object = [];
    return sanitize({ object, text });
}
exports.createObjectExpressionNode = createObjectExpressionNode;
function createObjectPairExpressionNode(key, value, text) {
    return sanitize({ key, value, text });
}
exports.createObjectPairExpressionNode = createObjectPairExpressionNode;
function createLambdaExpressionNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return createLambdaTypeNode(parameters, type, text);
}
exports.createLambdaExpressionNode = createLambdaExpressionNode;
function createParenthesizedExpressioneNode(expression, optional = false, text) {
    return { parenthesized: sanitize({ expression, optional, text }) };
}
exports.createParenthesizedExpressioneNode = createParenthesizedExpressioneNode;
;
function createLiteralExpressionNode(type, text) {
    return { literal: sanitize({ type, text }) };
}
exports.createLiteralExpressionNode = createLiteralExpressionNode;
function createDescriptionNode(text, inlines) {
    if (!inlines)
        inlines = [];
    return { description: sanitize({ text, inlines }) };
}
exports.createDescriptionNode = createDescriptionNode;
function createInlineTagNode(identifier, body, text) {
    return sanitize({ identifier, body, text });
}
exports.createInlineTagNode = createInlineTagNode;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWERvY0FTVE5vZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvWERvY0FTVE5vZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw0QkFBNEI7QUFDNUIsbUJBQW1CO0FBRW5COzs7Ozs7OztHQVFHO0FBQ0gsa0JBQWtCLE1BQU07SUFDdEIscUZBQXFGO0lBQ3JGLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUN6QixDQUFDO0FBRUQ7Ozs7Ozs7Ozs7R0FVRztBQUNILGlDQUNFLElBQWMsRUFDZCxJQUFhO0lBRWIsT0FBTyxFQUFFLGFBQWEsRUFBRSxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFBO0FBQ3BELENBQUM7QUFMRCwwREFLQztBQVNEOztHQUVHO0FBQ0gsd0JBQ0UsV0FBNEIsRUFDNUIsSUFBYTtJQUViLE9BQU8sUUFBUSxDQUFDLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUE7QUFDeEMsQ0FBQztBQUxELHdDQUtDO0FBU0QsU0FBUztBQUVULHVCQUNFLElBQWlCLEVBQ2pCLFVBQThDLEVBQzlDLElBQWMsRUFDZCxVQUEwQixFQUMxQixXQUE0QixFQUM1QixJQUFhO0lBRWIsT0FBTyxRQUFRLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUNoRyxDQUFDO0FBVEQsc0NBU0M7QUFXRCwyQkFDRSxJQUFvQixFQUNwQixJQUFhO0lBRWIsT0FBTyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtBQUNqQyxDQUFDO0FBTEQsOENBS0M7QUFPRCxpQ0FDRSxVQUErRCxFQUMvRCxRQUFnRCxFQUNoRCxJQUFhO0lBRWIsSUFBSSxJQUFJ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QUUsVUFBVSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO0FBQzdDLENBQUM7QUFORCxrREFNQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuLyogRG9jdW1lbnRhdGlvbiAqL1xuXG4vKipcbiAqIFJlbW92ZXMgdW5kZWZpbmVkLCBudWxsLCBhbmQgZmFsc2UgcHJvcGVydGllcyBmcm9tIGFuIG9iamVjdC5cbiAqIFxuICogIyBBUElcbiAqIFxuICogYGBgXG4gKiBAcGFyYW0gb2JqZWN0XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gc2FuaXRpemUob2JqZWN0KSB7XG4gIC8vIE9iamVjdC5rZXlzKG9iamVjdCkuZm9yRWFjaCgoa2V5KSA9PiAob2JqZWN0W2tleV0gPT0gbnVsbCkgJiYgZGVsZXRlIG9iamVjdFtrZXldKTtcbiAgcmV0dXJuIF8ucGlja0J5KG9iamVjdClcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgRG9jdW1lbnRhdGlvbiBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBwYXJhbSBib2R5OiBCb2R5Tm9kZSAtIFRoZSBib2R5IG5vZGUuIFNlZS4ge0BsaW5rIFhEb2NBU1ROb2RlLnRzOjpCb2R5Tm9kZX1cbiAqIEBwYXJhbSB0ZXh0Pzogc3RyaW5nIC0gVGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYm9keSBub2RlLlxuICogQHJldHVybiBEb2N1bWVudGF0aW9uTm9kZSAtIFNlZSB7QGxpbmsgWERvY0FTVE5vZGUudHM6OkRvY3VtZW50YXRpb25Ob2RlfS5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRhdGlvbk5vZGUoXG4gIGJvZHk6IEJvZHlOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBEb2N1bWVudGF0aW9uTm9kZSB7XG4gIHJldHVybiB7IGRvY3VtZW50YXRpb246IHNhbml0aXplKHsgYm9keSwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9jdW1lbnRhdGlvbk5vZGUge1xuICBkb2N1bWVudGF0aW9uOiB7XG4gICAgYm9keTogQm9keU5vZGUsXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIEJvZHkgbm9kZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJvZHlOb2RlKFxuICBhbm5vdGF0aW9uczogQW5ub3RhdGlvbnNOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBCb2R5Tm9kZSB7XG4gIHJldHVybiBzYW5pdGl6ZSh7IGFubm90YXRpb25zLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9keU5vZGUge1xuICBhbm5vdGF0aW9uczogVGFnTm9kZVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IHR5cGUgQW5ub3RhdGlvbnNOb2RlID0gVGFnTm9kZVtdIHwgdW5kZWZpbmVkW107XG5cbi8qIFRhZyAqL1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGFnTm9kZShcbiAgbmFtZTogVGFnTmFtZU5vZGUsXG4gIGlkZW50aWZpZXI6IFRhZ0lkZW50aWZpZXJOb2RlIHwgSWRlbnRpZmllck5vZGUsXG4gIHR5cGU6IFR5cGVOb2RlLFxuICBleHByZXNzaW9uOiBFeHByZXNzaW9uTm9kZSxcbiAgZGVzY3JpcHRpb246IERlc2NyaXB0aW9uTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogVGFnTm9kZSB7XG4gIHJldHVybiBzYW5pdGl6ZShPYmplY3QuYXNzaWduKHt9LCBuYW1lLCBpZGVudGlmaWVyLCB7IHR5cGUgfSwgZXhwcmVzc2lvbiwgZGVzY3JpcHRpb24sIHRleHQpKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUYWdOb2RlIHtcbiAgbmFtZT86IFRhZ05hbWVOb2RlLFxuICBpZGVudGlmaWVyPzogVGFnSWRlbnRpZmllck5vZGUgfCBJZGVudGlmaWVyTm9kZSxcbiAgdHlwZT86IFR5cGVOb2RlLFxuICBleHByZXNzaW9uPzogRXhwcmVzc2lvbk5vZGUsXG4gIGRlc2NyaXB0aW9uPzogRGVzY3JpcHRpb25Ob2RlLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYWdOYW1lTm9kZShcbiAgbmFtZTogSWRlbnRpZmllck5vZGUsXG4gIHRleHQ/OiBzdHJpbmdcbik6IFRhZ05hbWVOb2RlIHtcbiAgcmV0dXJuIHNhbml0aXplKHsgbmFtZSwgdGV4dCB9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ05hbWVOb2RlIHtcbiAgbmFtZTogSWRlbnRpZmllck5vZGUsXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhZ0lkZW50aWZpZXJOb2RlKFxuICBpZGVudGlmaWVyOiBJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsSWRlbnRpZmllck5vZGUgfCB1bmRlZmluZWQsXG4gIHByb3BlcnR5PzogUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZSB8IHVuZGVmaW5lZCxcbiAgdGV4dD86IHN0cmluZ1xuKTogVGFnSWRlbnRpZmllck5vZGUge1xuICBsZXQgbm9kZSA9IHt9XG4gIGlmIChpZGVudGlmaWVyKSBPYmplY3QuYXNzaWduKG5vZGUsIHsgaWRlbnRpZmllciwgdGV4dCB9KVxuICBlbHNlIGlmIChwcm9wZXJ0eSkgT2JqZWN0LmFzc2lnbihub2RlLCB7IHByb3BlcnR5LCB0ZXh0IH0pXG4gIHJldHVybiBzYW5pdGl6ZShub2RlKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUYWdJZGVudGlmaWVyTm9kZSB7XG4gIGlkZW50aWZpZXI/OiBJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGVcbiAgcHJvcGVydHk/OiBQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlKFxuICBpZGVudGlmaWVyOiBPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlXG4pOiBPcHRpb25hbElkZW50aWZpZXJOb2RlIHtcbiAgcmV0dXJuIGlkZW50aWZpZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSBleHRlbmRzIE9wdGlvbmFsSWRlbnRpZmllck5vZGUgeyB9XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUoXG4gIHByb3BlcnR5OiAoSWRlbnRpZmllck5vZGUgfCBPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlKVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUge1xuICByZXR1cm4gc2FuaXRpemUoeyBwcm9wZXJ0eSwgdGV4dCB9KVxufVxuZXhwb3J0IGludGVyZmFjZSBQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlIHtcbiAgLy8gU2hvcnRjdXQgb2YgT3B0aW9uYWxUYWdPcklkZW50aWZpZXJcbiAgcHJvcGVydHk6IChJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUpW10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSWRlbnRpZmllck5vZGUoXG4gIHRleHQ6IHN0cmluZyxcbiAgb3B0aW9uYWwgPSBmYWxzZSxcbiAgcHJvcGVydHk/OiBJZGVudGlmaWVyTm9kZVtdIHwgdW5kZWZpbmVkW10sXG4pOiBJZGVudGlmaWVyTm9kZSB7XG4gIGlmICghb3B0aW9uYWwpIG9wdGlvbmFsID0gZmFsc2U7XG4gIGlmICghcHJvcGVydHkpIHByb3BlcnR5ID0gW11cblxuICByZXR1cm4geyBpZGVudGlmaWVyOiBzYW5pdGl6ZSh7IG9wdGlvbmFsLCBwcm9wZXJ0eSwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSWRlbnRpZmllck5vZGUge1xuICBpZGVudGlmaWVyOiB7XG4gICAgb3B0aW9uYWw6IGJvb2xlYW4sXG4gICAgcHJvcGVydHk6IElkZW50aWZpZXJOb2RlW10gfCB1bmRlZmluZWRbXVxuICAgIHRleHQ6IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVPcHRpb25hbElkZW50aWZpZXJOb2RlKFxuICBvcHRpb25hbCA9IHRydWUsXG4gIHByb3BlcnR5OiBJZGVudGlmaWVyTm9kZVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IE9wdGlvbmFsSWRlbnRpZmllck5vZGUge1xuICByZXR1cm4gY3JlYXRlSWRlbnRpZmllck5vZGUodGV4dCwgb3B0aW9uYWwsIHByb3BlcnR5LCApO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9wdGlvbmFsSWRlbnRpZmllck5vZGUgZXh0ZW5kcyBJZGVudGlmaWVyTm9kZSB7IH1cblxuXG4vKiBUeXBlICovXG5cbi8qKlxuICogXG4gKiBDcmVhdGVzIGEgVHlwZSBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBleHBvcnRcbiAqIEBmdW5jdGlvbiBjcmVhdGVUeXBlTm9kZVxuICogQHBhcmFtIHR5cGU6IFVuaW9uVHlwZU5vZGVcbiAqIHwgTGFtYmRhVHlwZU5vZGVcbiAqIHwgVHVwbGVUeXBlTm9kZVxuICogfCBQcmltYXJ5VHlwZU5vZGVcbiAqIHwgUGFyZW50aGVzaXplZFR5cGVOb2RlXG4gKiB8IFVuYXJ5VHlwZU5vZGVcbiAqIHwgT2JqZWN0VHlwZU5vZGVcbiAqIHwgQXJyYXlUeXBlTm9kZVxuICogfCBQcm9wZXJ0eVR5cGVOb2RlXG4gKiAtIFRoZSB0eXBlIG9mIG5vZGUgdG8gY3JlYXRlLlxuICogQHBhcmFtIG9wdGlvbmFsID0gZmFsc2UgXG4gKiAtIERldGVybWluZXMgd2hldGhlciB0aGUgdHlwZSBvZiBub2RlIGlzIG9wdGlvbmFsLlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUeXBlTm9kZShcbiAgdHlwZTogSW50ZXJzZWN0VHlwZU5vZGVcbiAgICB8IFVuaW9uVHlwZU5vZGVcbiAgICB8IExhbWJkYVR5cGVOb2RlXG4gICAgfCBUdXBsZVR5cGVOb2RlXG4gICAgfCBQcmltYXJ5VHlwZU5vZGVcbiAgICB8IFBhcmVudGhlc2l6ZWRUeXBlTm9kZVxuICAgIHwgVW5hcnlUeXBlTm9kZVxuICAgIHwgT2JqZWN0VHlwZU5vZGVcbiAgICB8IEFycmF5VHlwZU5vZGVcbiAgICB8IFByb3BlcnR5SWRlbnRpZmllck5vZGUsXG4gIG9wdGlvbmFsID0gZmFsc2UsXG4gIHRleHQ/OiBzdHJpbmdcbik6IFR5cGVOb2RlIHtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHR5cGUsIHNhbml0aXplKHsgb3B0aW9uYWwsIHRleHQgfSkpXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHlwZU5vZGUge1xuICBpbnRlcnNlY3Q/OiBJbnRlcnNlY3RUeXBlTm9kZSxcbiAgdW5pb24/OiBVbmlvblR5cGVOb2RlLFxuICBsYW1iZGE/OiBMYW1iZGFUeXBlTm9kZSxcbiAgdHVwbGU/OiBUdXBsZVR5cGVOb2RlLFxuICBwcmltYXJ5PzogUHJpbWFyeVR5cGVOb2RlLFxuICBwYXJlbnRoZXNpemVkPzogUGFyZW50aGVzaXplZFR5cGVOb2RlLFxuICB1bmFyeT86IFVuYXJ5VHlwZU5vZGUsXG4gIG9iamVjdD86IE9iamVjdFR5cGVOb2RlLFxuICBhcnJheT86IEFycmF5VHlwZU5vZGUsXG4gIHByb3BlcnR5PzogUHJvcGVydHlJZGVudGlmaWVyTm9kZSxcbiAgb3B0aW9uYWw6IGJvb2xlYW4sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIEludGVyc2VjdGlvblR5cGUgbm9kZS5cbiAqIFxuICogIyBBUElcbiAqIFxuICogYGBgXG4gKiBAcHVibGljIGxlZnQ6IFR5cGVOb2RlIC0gVGhlIHR5cGUgb2Ygbm9kZSB0aGF0IGFwcGVhcnMgb24gdGhlIGxlZnQtaGFuZCBzaWRlLlxuICogQHB1YmxpYyByaWdodDogVHlwZU5vZGUgLSBUaGUgdHlwZSBvZiBub2RlIHRoYXQgYXBwZWFycyBvbiB0aGUgcmlnaHQtaGFuZCBzaWRlLlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnRlcnNlY3RUeXBlTm9kZShcbiAgbGVmdDogVHlwZU5vZGUsXG4gIHJpZ2h0OiBUeXBlTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogSW50ZXJzZWN0VHlwZU5vZGUge1xuICByZXR1cm4geyBpbnRlcnNlY3Q6IHNhbml0aXplKHsgbGVmdCwgcmlnaHQsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEludGVyc2VjdFR5cGVOb2RlIHtcbiAgaW50ZXJzZWN0OiB7XG4gICAgbGVmdDogVHlwZU5vZGUsXG4gICAgcmlnaHQ6IFR5cGVOb2RlLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG5cbi8qKlxuICogQ3JlYXRlcyBhbiBVbmlvblR5cGUgbm9kZS5cbiAqIFxuICogIyBBUElcbiAqIFxuICogYGBgXG4gKiBAZXhwb3J0XG4gKiBAcHVibGljIGxlZnQ6IFR5cGVOb2RlIC0gVGhlIHR5cGUgb2Ygbm9kZSB0aGF0IGFwcGVhcnMgb24gdGhlIGxlZnQtaGFuZCBzaWRlLlxuICogQHB1YmxpYyByaWdodDogVHlwZU5vZGUgLSBUaGUgdHlwZSBvZiBub2RlIHRoYXQgYXBwZWFycyBvbiB0aGUgcmlnaHQtaGFuZCBzaWRlLlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVVbmlvblR5cGVOb2RlKFxuICBsZWZ0OiBUeXBlTm9kZSxcbiAgcmlnaHQ6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBVbmlvblR5cGVOb2RlIHtcbiAgcmV0dXJuIHsgdW5pb246IHNhbml0aXplKHsgbGVmdCwgcmlnaHQsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVuaW9uVHlwZU5vZGUge1xuICB1bmlvbjoge1xuICAgIGxlZnQ6IFR5cGVOb2RlLFxuICAgIHJpZ2h0OiBUeXBlTm9kZSxcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgTGFtYmRhVHlwZSBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIC0gVGhlIHNpbmdsZSBwYXJhbWV0ZXIgaW4gYSBsYW1iZGEgdHlwZS5cbiAqIEBwYXJhbSBwYXJhbWV0ZXJzOiBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jY2UgfCB1bmRlZmluZWRbXSB8IG51bGxcbiAqIC0gVGhlIHNlcXVlbmNlIG9mIHBhcmFtZXRlcnMgaW4gYSBsYW1iZGEgdHlwZS5cbiAqIEBwYXJhbSB0eXBlOiBUeXBlTm9kZVxuICogLSBUaGUgcmV0dXJuIHR5cGUgaW4gYSBsYW1iZGEgdHlwZS5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTGFtYmRhVHlwZU5vZGUoXG4gIHBhcmFtZXRlcnM6IEZvcm1hbFBhcmFtZXRlclNlcXVlbmNlTm9kZSB8IHVuZGVmaW5lZFtdLFxuICB0eXBlOiBUeXBlTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogTGFtYmRhVHlwZU5vZGUge1xuICBpZiAoIXBhcmFtZXRlcnMpIHBhcmFtZXRlcnMgPSBbXVxuICByZXR1cm4geyBsYW1iZGE6IHNhbml0aXplKHsgcGFyYW1ldGVycywgdHlwZSwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGFtYmRhVHlwZU5vZGUge1xuICBsYW1iZGE6IHtcbiAgICBwYXJhbWV0ZXJzOiBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGUgfCB1bmRlZmluZWRbXSxcbiAgICB0eXBlOiBUeXBlTm9kZSxcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUZvcm1hbFBhcmVtZXRlclNlcXVlbmNlTm9kZShcbiAgcGFyYW1ldGVyczogUGFyYW1ldGVyTm9kZVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IEZvcm1hbFBhcmFtZXRlclNlcXVlbmNlTm9kZSB7XG4gIHJldHVybiB7IHBhcmFtZXRlcnMsIHRleHQgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZvcm1hbFBhcmFtZXRlclNlcXVlbmNlTm9kZSB7XG4gIHBhcmFtZXRlcnM6IFBhcmFtZXRlck5vZGVbXSB8IHVuZGVmaW5lZFtdLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYXJhbWV0ZXJOb2RlKFxuICBpZGVudGlmaWVyOiBJZGVudGlmaWVyTm9kZSxcbiAgdHlwZT86IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJhbWV0ZXJOb2RlIHtcbiAgcmV0dXJuIHNhbml0aXplKHsgaWRlbnRpZmllciwgdHlwZSwgdGV4dCB9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhcmFtZXRlck5vZGUge1xuICBpZGVudGlmaWVyOiBJZGVudGlmaWVyTm9kZSxcbiAgdHlwZT86IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUdXBsZVR5cGVOb2RlKFxuICBpZGVudGlmaWVyOiBJZGVudGlmaWVyTm9kZSxcbiAgdHlwZXM6IFR5cGVOb2RlW10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogVHVwbGVUeXBlTm9kZSB7XG4gIHJldHVybiBzYW5pdGl6ZSh7IGlkZW50aWZpZXIsIHR5cGVzLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHVwbGVUeXBlTm9kZSB7XG4gIGlkZW50aWZpZXI/OiBJZGVudGlmaWVyTm9kZSxcbiAgdHlwZXM6IFR5cGVOb2RlW10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUHJpbWFyeVR5cGVOb2RlKFxuICBwcmltYXJ5OiBPcHRpb25hbElkZW50aWZpZXJOb2RlIHwgKElkZW50aWZpZXJOb2RlIHwgS2V5d29yZE5vZGUpLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQcmltYXJ5VHlwZU5vZGUge1xuICByZXR1cm4gc2FuaXRpemUoeyBwcmltYXJ5LCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJpbWFyeVR5cGVOb2RlIHtcbiAgcHJpbWFyeTogT3B0aW9uYWxJZGVudGlmaWVyTm9kZSB8IChJZGVudGlmaWVyTm9kZSB8IEtleXdvcmROb2RlKSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlS2V5d29yZE5vZGUoXG4gIHRleHQ6IHN0cmluZyB8IFwibnVsbFwiIHwgXCJ1bmRlZmluZWRcIlxuKTogS2V5d29yZE5vZGUge1xuICByZXR1cm4geyBrZXl3b3JkOiB7IHRleHQgfSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2V5d29yZE5vZGUge1xuICBrZXl3b3JkOiB7XG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYXJlbnRoZXNpemVkVHlwZU5vZGUoXG4gIHR5cGU6IFR5cGVOb2RlLFxuICBvcHRpb25hbCA9IGZhbHNlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJlbnRoZXNpemVkVHlwZU5vZGUge1xuICByZXR1cm4geyBwYXJlbnRoZXNpemVkOiBzYW5pdGl6ZSh7IHR5cGUsIG9wdGlvbmFsLCB0ZXh0IH0pIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFyZW50aGVzaXplZFR5cGVOb2RlIHtcbiAgcGFyZW50aGVzaXplZDoge1xuICAgIHR5cGU6IFR5cGVOb2RlLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVVbmFyeVR5cGVOb2RlKFxuICBvcGVyYXRvcjogc3RyaW5nIHwgXCImXCIgfCBcIipcIixcbiAgcmlnaHQ6IFByaW1hcnlUeXBlTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogVW5hcnlUeXBlTm9kZSB7XG4gIHJldHVybiB7IHVuYXJ5OiBzYW5pdGl6ZSh7IG9wZXJhdG9yLCByaWdodCwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5hcnlUeXBlTm9kZSB7XG4gIHVuYXJ5OiB7XG4gICAgb3BlcmF0b3I6IHN0cmluZyB8IFwiJlwiIHwgXCIqXCIsXG4gICAgcmlnaHQ6IFByaW1hcnlUeXBlTm9kZSxcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdFR5cGVOb2RlKFxuICBvYmplY3Q/OiBPYmplY3RQYWlyVHlwZU5vZGVbXSB8IHVuZGVmaW5lZFtdLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBPYmplY3RUeXBlTm9kZSB7XG4gIGlmICghb2JqZWN0KSBvYmplY3QgPSBbXTtcbiAgcmV0dXJuIHNhbml0aXplKHsgb2JqZWN0LCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0VHlwZU5vZGUge1xuICBvYmplY3Q6IE9iamVjdFBhaXJUeXBlTm9kZVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdFBhaXJUeXBlTm9kZShcbiAga2V5OiBUeXBlTm9kZSxcbiAgdmFsdWU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBPYmplY3RQYWlyVHlwZU5vZGUge1xuICByZXR1cm4gc2FuaXRpemUoeyBrZXksIHZhbHVlLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0UGFpclR5cGVOb2RlIHtcbiAga2V5OiBUeXBlTm9kZSxcbiAgdmFsdWU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBcnJheVR5cGVOb2RlKFxuICB0eXBlOiBUeXBlTm9kZSxcbiAgdHlwZXM6IFR5cGVOb2RlW10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogQXJyYXlUeXBlTm9kZSB7XG4gIGlmICghdHlwZXMpIHR5cGVzID0gW107XG5cbiAgcmV0dXJuIHsgYXJyYXk6IHNhbml0aXplKHsgdHlwZSwgdHlwZXMsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFycmF5VHlwZU5vZGUge1xuICBhcnJheToge1xuICAgIHR5cGU/OiBUeXBlTm9kZSxcbiAgICB0eXBlcz86IFR5cGVOb2RlW10gfCB1bmRlZmluZWRbXSxcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5SWRlbnRpZmllck5vZGUoXG4gIHByb3BlcnR5OiBJZGVudGlmaWVyTm9kZVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ6IHN0cmluZ1xuKTogUHJvcGVydHlJZGVudGlmaWVyTm9kZSB7XG4gIHJldHVybiBjcmVhdGVJZGVudGlmaWVyTm9kZSh0ZXh0LCBmYWxzZSwgcHJvcGVydHkpXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb3BlcnR5SWRlbnRpZmllck5vZGUgZXh0ZW5kcyBJZGVudGlmaWVyTm9kZSB7IH1cblxuXG4vKiBFeHByZXNzaW9uICovXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUV4cHJlc3Npb25Ob2RlKFxuICBleHByZXNzaW9uOlxuICAgIFVuYXJ5RXhwcmVzc2lvbk5vZGVcbiAgICB8IEJpbmFyeUV4cHJlc3Npb25Ob2RlXG4gICAgfCBBcnJheUV4cHJlc3Npb25Ob2RlXG4gICAgfCBPYmplY3RFeHByZXNzaW9uTm9kZVxuICAgIHwgTGFtYmRhRXhwcmVzc2lvbk5vZGVcbiAgICB8IExpdGVyYWxFeHByZXNzaW9uTm9kZVxuICAgIHwgUGFyZW50aGVzaXplZEV4cHJlc3Npb25Ob2RlLFxuICB0ZXh0Pzogc3RyaW5nLFxuKTogRXhwcmVzc2lvbk5vZGUge1xuICByZXR1cm4gc2FuaXRpemUoeyBleHByZXNzaW9uLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXhwcmVzc2lvbk5vZGUge1xuICBleHByZXNzaW9uOlxuICBVbmFyeUV4cHJlc3Npb25Ob2RlXG4gIHwgQmluYXJ5RXhwcmVzc2lvbk5vZGVcbiAgfCBBcnJheUV4cHJlc3Npb25Ob2RlXG4gIHwgT2JqZWN0RXhwcmVzc2lvbk5vZGVcbiAgfCBMYW1iZGFFeHByZXNzaW9uTm9kZVxuICB8IExpdGVyYWxFeHByZXNzaW9uTm9kZVxuICB8IFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZVxuICB0ZXh0Pzogc3RyaW5nXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVuYXJ5RXhwcmVzc2lvbk5vZGUoXG4gIG9wZXJhdG9yOiBzdHJpbmcgfCAnKycgfCAnLScsXG4gIHJpZ2h0OiBFeHByZXNzaW9uTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogVW5hcnlFeHByZXNzaW9uTm9kZSB7XG4gIHJldHVybiB7IHVuYXJ5OiBzYW5pdGl6ZSh7IG9wZXJhdG9yLCByaWdodCwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5hcnlFeHByZXNzaW9uTm9kZSB7XG4gIHVuYXJ5OiB7XG4gICAgb3BlcmF0b3I6IHN0cmluZyB8ICcrJyB8ICctJyxcbiAgICByaWdodDogRXhwcmVzc2lvbk5vZGUsXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCaW5hcnlFeHByZXNzaW9uTm9kZShcbiAgb3BlcmF0b3I6IHN0cmluZyB8ICcrJyB8ICctJyxcbiAgbGVmdDogRXhwcmVzc2lvbk5vZGUsXG4gIHJpZ2h0OiBFeHByZXNzaW9uTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogQmluYXJ5RXhwcmVzc2lvbk5vZGUge1xuICByZXR1cm4geyBiaW5hcnk6IHNhbml0aXplKHsgbGVmdCwgcmlnaHQsIG9wZXJhdG9yLCB0ZXh0IH0pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBCaW5hcnlFeHByZXNzaW9uTm9kZSB7XG4gIGJpbmFyeToge1xuICAgIGxlZnQ6IEV4cHJlc3Npb25Ob2RlLFxuICAgIHJpZ2h0OiBFeHByZXNzaW9uTm9kZSxcbiAgICBvcGVyYXRvcjogc3RyaW5nIHwgJysnIHwgJy0nIHwgJyonIHwgJy8nLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQXJyYXlFeHByZXNzaW9uTm9kZShcbiAgYXJyYXk/OiBFeHByZXNzaW9uTm9kZVtdLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBBcnJheUV4cHJlc3Npb25Ob2RlIHtcbiAgaWYgKCFhcnJheSkgYXJyYXkgPSBbXTtcbiAgcmV0dXJuIHNhbml0aXplKHsgYXJyYXksIHRleHQgfSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBcnJheUV4cHJlc3Npb25Ob2RlIHtcbiAgYXJyYXk6IEV4cHJlc3Npb25Ob2RlW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdEV4cHJlc3Npb25Ob2RlKFxuICBvYmplY3Q/OiBPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGVbXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogT2JqZWN0RXhwcmVzc2lvbk5vZGUge1xuICBpZiAoIW9iamVjdCkgb2JqZWN0ID0gW11cbiAgcmV0dXJuIHNhbml0aXplKHsgb2JqZWN0LCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0RXhwcmVzc2lvbk5vZGUge1xuICBvYmplY3Q6IE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZVtdLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGUoXG4gIGtleTogTGl0ZXJhbEV4cHJlc3Npb25Ob2RlLFxuICB2YWx1ZTogT2JqZWN0RXhwcmVzc2lvbk5vZGUgfCBMaXRlcmFsRXhwcmVzc2lvbk5vZGUsXG4gIHRleHQ/OiBzdHJpbmdcbik6IE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZSB7XG4gIHJldHVybiBzYW5pdGl6ZSh7IGtleSwgdmFsdWUsIHRleHQgfSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGUge1xuICBrZXk6IExpdGVyYWxFeHByZXNzaW9uTm9kZSxcbiAgdmFsdWU6IE9iamVjdEV4cHJlc3Npb25Ob2RlIHwgTGl0ZXJhbEV4cHJlc3Npb25Ob2RlLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMYW1iZGFFeHByZXNzaW9uTm9kZShcbiAgcGFyYW1ldGVyczogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlIHwgdW5kZWZpbmVkW10sXG4gIHR5cGU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBMYW1iZGFFeHByZXNzaW9uTm9kZSB7XG4gIGlmICghcGFyYW1ldGVycykgcGFyYW1ldGVycyA9IFtdXG4gIHJldHVybiBjcmVhdGVMYW1iZGFUeXBlTm9kZShwYXJhbWV0ZXJzLCB0eXBlLCB0ZXh0KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExhbWJkYUV4cHJlc3Npb25Ob2RlIGV4dGVuZHMgTGFtYmRhVHlwZU5vZGUgeyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYXJlbnRoZXNpemVkRXhwcmVzc2lvbmVOb2RlKFxuICBleHByZXNzaW9uOiBFeHByZXNzaW9uTm9kZSxcbiAgb3B0aW9uYWwgPSBmYWxzZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFyZW50aGVzaXplZEV4cHJlc3Npb25Ob2RlIHtcbiAgcmV0dXJuIHsgcGFyZW50aGVzaXplZDogc2FuaXRpemUoeyBleHByZXNzaW9uLCBvcHRpb25hbCwgdGV4dCB9KSB9O1xufVxuZXhwb3J0IGludGVyZmFjZSBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGUgeyBcbiAgcGFyZW50aGVzaXplZDoge1xuICAgIGV4cHJlc3Npb246IEV4cHJlc3Npb25Ob2RlLFxuICAgIG9wdGlvbmFsOiBib29sZWFuLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufTtcblxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKFxuICB0eXBlOiBzdHJpbmcsXG4gIHRleHQ6IHN0cmluZ1xuKTogTGl0ZXJhbEV4cHJlc3Npb25Ob2RlIHtcbiAgcmV0dXJuIHsgbGl0ZXJhbDogc2FuaXRpemUoeyB0eXBlLCB0ZXh0IH0pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBMaXRlcmFsRXhwcmVzc2lvbk5vZGUge1xuICBsaXRlcmFsOiB7XG4gICAgdHlwZTogc3RyaW5nLFxuICAgIHRleHQ/OiBzdHJpbmcsXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlc2NyaXB0aW9uTm9kZShcbiAgdGV4dDogc3RyaW5nLFxuICBpbmxpbmVzPzogSW5saW5lVGFnTm9kZVtdXG4pOiBEZXNjcmlwdGlvbk5vZGUge1xuICBpZiAoIWlubGluZXMpIGlubGluZXMgPSBbXVxuICByZXR1cm4geyBkZXNjcmlwdGlvbjogc2FuaXRpemUoeyB0ZXh0LCBpbmxpbmVzIH0pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXNjcmlwdGlvbk5vZGUge1xuICBkZXNjcmlwdGlvbjoge1xuICAgIHRleHQ6IHN0cmluZyxcbiAgICBpbmxpbmVzPzogSW5saW5lVGFnTm9kZVtdXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUlubGluZVRhZ05vZGUoXG4gIGlkZW50aWZpZXI6IElkZW50aWZpZXJOb2RlLFxuICBib2R5OiBzdHJpbmcsXG4gIHRleHQ/OiBzdHJpbmdcbik6IElubGluZVRhZ05vZGUge1xuICByZXR1cm4gc2FuaXRpemUoeyBpZGVudGlmaWVyLCBib2R5LCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5saW5lVGFnTm9kZSB7XG4gIGlkZW50aWZpZXI6IElkZW50aWZpZXJOb2RlLFxuICBib2R5OiBzdHJpbmcsXG4gIHRleHQ/OiBzdHJpbmdcbn0iXX0=